

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trainers &mdash; Pytorch-Sconce master documentation</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato" type="text/css" />
  <link rel="stylesheet" href="_static/css/pytorch_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Schedules" href="schedules.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Pytorch-Sconce
          

          
          </a>

          
            
            
              <div class="version">
                master (1.3.2 )
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Class Reference</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="data_feeds.html">Data Feeds</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_feeds.html#datafeed"><span class="hidden-section">DataFeed</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data_feeds.html#imagefeed"><span class="hidden-section">ImageFeed</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data_feeds.html#singleclassimagefeed"><span class="hidden-section">SingleClassImageFeed</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="data_feeds.html#multiclassimagefeed"><span class="hidden-section">MultiClassImageFeed</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="datasets.html">Datasests</a><ul>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#csvimagefolder"><span class="hidden-section">CsvImageFolder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="datasets.html#simpledots"><span class="hidden-section">SimpleDots</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="transforms.html#nhot"><span class="hidden-section">NHot</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="monitors.html">Monitors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="monitors.html#monitor"><span class="hidden-section">Monitor</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="monitors.html#compositemonitor"><span class="hidden-section">CompositeMonitor</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="monitors.html#dataframemonitor"><span class="hidden-section">DataframeMonitor</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="monitors.html#losswisemonitor"><span class="hidden-section">LosswiseMonitor</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="monitors.html#ringbuffermonitor"><span class="hidden-section">RingbufferMonitor</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="monitors.html#stdoutmonitor"><span class="hidden-section">StdoutMonitor</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="models.html#model"><span class="hidden-section">Model</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#basicautoencoder"><span class="hidden-section">BasicAutoencoder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#basicconvolutionalautoencoder"><span class="hidden-section">BasicConvolutionalAutoencoder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#variationalautoencoder"><span class="hidden-section">VariationalAutoencoder</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#basicclassifer"><span class="hidden-section">BasicClassifer</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#multilayerperceptron"><span class="hidden-section">MultilayerPerceptron</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#wideresnetimageclassifier"><span class="hidden-section">WideResnetImageClassifier</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameter_group.html">Parameter Group</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parameter_group.html#parametergroup"><span class="hidden-section">ParameterGroup</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="schedules.html">Schedules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="schedules.html#schedule"><span class="hidden-section">Schedule</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="schedules.html#cosine"><span class="hidden-section">Cosine</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="schedules.html#exponential"><span class="hidden-section">Exponential</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="schedules.html#linear"><span class="hidden-section">Linear</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="schedules.html#step"><span class="hidden-section">Step</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="schedules.html#triangle"><span class="hidden-section">Triangle</span></a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Trainers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-trainer"><span class="hidden-section">Basic Trainer</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#autoencodertrainer"><span class="hidden-section">AutoencoderTrainer</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="#singleclassimageclassifiertrainer"><span class="hidden-section">SingleClassImageClassifierTrainer</span></a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pytorch-Sconce</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Trainers</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/trainers.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trainers">
<h1>Trainers<a class="headerlink" href="#trainers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="basic-trainer">
<h2><span class="hidden-section">Basic Trainer</span><a class="headerlink" href="#basic-trainer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sconce.trainer.Trainer">
<em class="property">class </em><code class="descclassname">sconce.trainer.</code><code class="descname">Trainer</code><span class="sig-paren">(</span><em>*</em>, <em>model</em>, <em>validation_feed=None</em>, <em>training_feed=None</em>, <em>monitor=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>A Class that is used to train sconce models.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first last simple">
<li><strong>model</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code>) – the sconce model to be trained.  See <a class="reference internal" href="models.html#module-sconce.models" title="sconce.models"><code class="xref py py-mod docutils literal notranslate"><span class="pre">sconce.models</span></code></a>
for examples.</li>
<li><strong>training_feed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFeed</span></code>) – used during training to provide <cite>inputs</cite> and
<cite>targets</cite>.</li>
<li><strong>validation_feed</strong> (<code class="xref py py-class docutils literal notranslate"><span class="pre">DataFeed</span></code>) – <cite>targets</cite>.  These are never used for back-propagation.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
training.  This data can be sent to external systems during training or kept until training completes
allowing you to analyze training or make plots. If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="sconce.trainer.Trainer.checkpoint">
<code class="descname">checkpoint</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model state and retain filename for a later call to <a class="reference internal" href="#sconce.trainer.Trainer.restore" title="sconce.trainer.Trainer.restore"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restore()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em><em>, </em><em>optional</em>) – the filename to save the model state to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.load_model_state">
<code class="descname">load_model_state</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.load_model_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.load_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore model state frome a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em>) – the filename to where the model’s state was saved.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.multi_train">
<code class="descname">multi_train</code><span class="sig-paren">(</span><em>*</em>, <em>num_cycles</em>, <em>cycle_length=1</em>, <em>cycle_multiplier=2.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.multi_train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.multi_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs multiple training sessions one after another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_cycles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – [1, inf) the number of cycles to train for.</li>
<li><strong>cycle_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (0.0, inf) the length (in epochs) of the first cycle.</li>
<li><strong>cycle_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (0.0, inf) a factor used to determine the length of a cycle.  The length of a
cycle is equal to the length of the previous cycle (or <code class="docutils literal notranslate"><span class="pre">cycle_length</span></code> if it is the first cycle)
multiplied by <code class="docutils literal notranslate"><span class="pre">cycle_multiplier</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – are passed to the underlying <a class="reference internal" href="#sconce.trainer.Trainer.train" title="sconce.trainer.Trainer.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> method.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sconce.trainer.Trainer.num_trainable_parameters">
<code class="descname">num_trainable_parameters</code><a class="headerlink" href="#sconce.trainer.Trainer.num_trainable_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of trainable parameters that the models has.</p>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.restore">
<code class="descname">restore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.restore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore model to previously checkpointed state.  See also <a class="reference internal" href="#sconce.trainer.Trainer.checkpoint" title="sconce.trainer.Trainer.checkpoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">checkpoint()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.save_model_state">
<code class="descname">save_model_state</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.save_model_state"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.save_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model state to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em><em>, </em><em>optional</em>) – the filename to save the model state to.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a system dependent temporary location will be chosen.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the passed in filename, or the temporary filename chosen if <code class="docutils literal notranslate"><span class="pre">None</span></code> was passed in.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">filename (path)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.survey_learning_rate">
<code class="descname">survey_learning_rate</code><span class="sig-paren">(</span><em>*</em>, <em>num_epochs=1.0</em>, <em>min_learning_rate=1e-12</em>, <em>max_learning_rate=10</em>, <em>monitor=None</em>, <em>batch_multiplier=1</em>, <em>stop_factor=10</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.survey_learning_rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.survey_learning_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checkpoints a model, then runs a learning rate survey, before restoring the model back.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the number of epochs to train the model for.</li>
<li><strong>min_learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the minimum learning rate used in the survey.</li>
<li><strong>max_learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the maximum learning rate used in the survey.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
the learning rate survey.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</li>
<li><strong>batch_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – [1, inf) determines how often parameter updates will occur during
training.  If greater than 1, this simulates large batch sizes without increasing memory usage.  For
example, if the batch size were 100 and batch_multipler=10, the effective batch size would be 1,000, but
the memory usage would be for a batch size of 100.</li>
<li><strong>stop_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (1.0, inf) determines early stopping.  If the <cite>training loss</cite> rises by more than
this factor from it’s minimum value, the survey will stop.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the monitor used during this learning rate survey.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>*</em>, <em>num_epochs</em>, <em>monitor=None</em>, <em>validation_to_train_ratio=None</em>, <em>batch_multiplier=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model for a given number of epochs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – the number of epochs to train the model for.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – a monitor to use for this training session.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then self.monitor will be used.</li>
<li><strong>validation_to_train_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – [0.0, 1.0] determines how often (relative to training samples)
that test samples are run through the model during training.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the relative size of the
training and test datasets is used.  For example, for MNIST with 60,000 training samples and 10,000 test
samples, the value would be 1/6th.</li>
<li><strong>batch_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – [1, inf) determines how often parameter updates will occur during
training.  If greater than 1, this simulates large batch sizes without increasing memory usage.  For
example, if the batch size were 100 and batch_multipler=10, the effective batch size would be 1,000, but
the memory usage would be for a batch size of 100.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the monitor used during training.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainer.Trainer.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>*</em>, <em>monitor=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainer.html#Trainer.validate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainer.Trainer.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all samples of self.validation_feed through the model in test (inference) mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
this testing.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the monitor used during this testing.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="autoencodertrainer">
<h2><span class="hidden-section">AutoencoderTrainer</span><a class="headerlink" href="#autoencodertrainer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sconce.trainers.AutoencoderTrainer">
<em class="property">class </em><code class="descclassname">sconce.trainers.</code><code class="descname">AutoencoderTrainer</code><span class="sig-paren">(</span><em>*</em>, <em>model</em>, <em>validation_feed=None</em>, <em>training_feed=None</em>, <em>monitor=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainers/autoencoder_trainer.html#AutoencoderTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sconce.trainer.Trainer" title="sconce.trainer.Trainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">sconce.trainer.Trainer</span></code></a>, <a class="reference internal" href="sconce.trainers.html#sconce.trainers.autoencoder_trainer.AutoencoderMixin" title="sconce.trainers.autoencoder_trainer.AutoencoderMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sconce.trainers.autoencoder_trainer.AutoencoderMixin</span></code></a></p>
<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.checkpoint">
<code class="descname">checkpoint</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model state and retain filename for a later call to <a class="reference internal" href="#sconce.trainer.Trainer.restore" title="sconce.trainer.Trainer.restore"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restore()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em><em>, </em><em>optional</em>) – the filename to save the model state to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.load_model_state">
<code class="descname">load_model_state</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.load_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore model state frome a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em>) – the filename to where the model’s state was saved.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.multi_train">
<code class="descname">multi_train</code><span class="sig-paren">(</span><em>*</em>, <em>num_cycles</em>, <em>cycle_length=1</em>, <em>cycle_multiplier=2.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.multi_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs multiple training sessions one after another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_cycles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – [1, inf) the number of cycles to train for.</li>
<li><strong>cycle_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (0.0, inf) the length (in epochs) of the first cycle.</li>
<li><strong>cycle_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (0.0, inf) a factor used to determine the length of a cycle.  The length of a
cycle is equal to the length of the previous cycle (or <code class="docutils literal notranslate"><span class="pre">cycle_length</span></code> if it is the first cycle)
multiplied by <code class="docutils literal notranslate"><span class="pre">cycle_multiplier</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – are passed to the underlying <a class="reference internal" href="#sconce.trainer.Trainer.train" title="sconce.trainer.Trainer.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> method.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sconce.trainers.AutoencoderTrainer.num_trainable_parameters">
<code class="descname">num_trainable_parameters</code><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.num_trainable_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of trainable parameters that the models has.</p>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.restore">
<code class="descname">restore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore model to previously checkpointed state.  See also <a class="reference internal" href="#sconce.trainer.Trainer.checkpoint" title="sconce.trainer.Trainer.checkpoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">checkpoint()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.save_model_state">
<code class="descname">save_model_state</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.save_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model state to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em><em>, </em><em>optional</em>) – the filename to save the model state to.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a system dependent temporary location will be chosen.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the passed in filename, or the temporary filename chosen if <code class="docutils literal notranslate"><span class="pre">None</span></code> was passed in.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">filename (path)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.survey_learning_rate">
<code class="descname">survey_learning_rate</code><span class="sig-paren">(</span><em>*</em>, <em>num_epochs=1.0</em>, <em>min_learning_rate=1e-12</em>, <em>max_learning_rate=10</em>, <em>monitor=None</em>, <em>batch_multiplier=1</em>, <em>stop_factor=10</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.survey_learning_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checkpoints a model, then runs a learning rate survey, before restoring the model back.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the number of epochs to train the model for.</li>
<li><strong>min_learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the minimum learning rate used in the survey.</li>
<li><strong>max_learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the maximum learning rate used in the survey.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
the learning rate survey.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</li>
<li><strong>batch_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – [1, inf) determines how often parameter updates will occur during
training.  If greater than 1, this simulates large batch sizes without increasing memory usage.  For
example, if the batch size were 100 and batch_multipler=10, the effective batch size would be 1,000, but
the memory usage would be for a batch size of 100.</li>
<li><strong>stop_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (1.0, inf) determines early stopping.  If the <cite>training loss</cite> rises by more than
this factor from it’s minimum value, the survey will stop.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the monitor used during this learning rate survey.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>*</em>, <em>num_epochs</em>, <em>monitor=None</em>, <em>validation_to_train_ratio=None</em>, <em>batch_multiplier=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model for a given number of epochs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – the number of epochs to train the model for.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – a monitor to use for this training session.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then self.monitor will be used.</li>
<li><strong>validation_to_train_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – [0.0, 1.0] determines how often (relative to training samples)
that test samples are run through the model during training.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the relative size of the
training and test datasets is used.  For example, for MNIST with 60,000 training samples and 10,000 test
samples, the value would be 1/6th.</li>
<li><strong>batch_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – [1, inf) determines how often parameter updates will occur during
training.  If greater than 1, this simulates large batch sizes without increasing memory usage.  For
example, if the batch size were 100 and batch_multipler=10, the effective batch size would be 1,000, but
the memory usage would be for a batch size of 100.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the monitor used during training.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.AutoencoderTrainer.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>*</em>, <em>monitor=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.AutoencoderTrainer.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all samples of self.validation_feed through the model in test (inference) mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
this testing.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the monitor used during this testing.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="singleclassimageclassifiertrainer">
<h2><span class="hidden-section">SingleClassImageClassifierTrainer</span><a class="headerlink" href="#singleclassimageclassifiertrainer" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer">
<em class="property">class </em><code class="descclassname">sconce.trainers.</code><code class="descname">SingleClassImageClassifierTrainer</code><span class="sig-paren">(</span><em>*</em>, <em>model</em>, <em>validation_feed=None</em>, <em>training_feed=None</em>, <em>monitor=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sconce/trainers/single_class_image_classifier_trainer.html#SingleClassImageClassifierTrainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sconce.trainer.Trainer" title="sconce.trainer.Trainer"><code class="xref py py-class docutils literal notranslate"><span class="pre">sconce.trainer.Trainer</span></code></a>, <a class="reference internal" href="sconce.trainers.html#sconce.trainers.single_class_image_classifier_trainer.SingleClassImageClassifierMixin" title="sconce.trainers.single_class_image_classifier_trainer.SingleClassImageClassifierMixin"><code class="xref py py-class docutils literal notranslate"><span class="pre">sconce.trainers.single_class_image_classifier_trainer.SingleClassImageClassifierMixin</span></code></a></p>
<p>A trainer with some methods that are handy when you’re training an image classifier model.  Specifically a model
that classifies images into a single class per image.</p>
<p>New in 0.10.0 (Used to be called ClassifierTrainer)</p>
<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.checkpoint">
<code class="descname">checkpoint</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model state and retain filename for a later call to <a class="reference internal" href="#sconce.trainer.Trainer.restore" title="sconce.trainer.Trainer.restore"><code class="xref py py-meth docutils literal notranslate"><span class="pre">restore()</span></code></a>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em><em>, </em><em>optional</em>) – the filename to save the model state to.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.load_model_state">
<code class="descname">load_model_state</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.load_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore model state frome a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em>) – the filename to where the model’s state was saved.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.multi_train">
<code class="descname">multi_train</code><span class="sig-paren">(</span><em>*</em>, <em>num_cycles</em>, <em>cycle_length=1</em>, <em>cycle_multiplier=2.0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.multi_train" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs multiple training sessions one after another.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_cycles</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – [1, inf) the number of cycles to train for.</li>
<li><strong>cycle_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (0.0, inf) the length (in epochs) of the first cycle.</li>
<li><strong>cycle_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (0.0, inf) a factor used to determine the length of a cycle.  The length of a
cycle is equal to the length of the previous cycle (or <code class="docutils literal notranslate"><span class="pre">cycle_length</span></code> if it is the first cycle)
multiplied by <code class="docutils literal notranslate"><span class="pre">cycle_multiplier</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-even field"><td>&#160;</td><td class="field-body"><p class="first last"><strong>**kwargs</strong> – are passed to the underlying <a class="reference internal" href="#sconce.trainer.Trainer.train" title="sconce.trainer.Trainer.train"><code class="xref py py-meth docutils literal notranslate"><span class="pre">train()</span></code></a> method.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.num_trainable_parameters">
<code class="descname">num_trainable_parameters</code><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.num_trainable_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of trainable parameters that the models has.</p>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.plot_samples">
<code class="descname">plot_samples</code><span class="sig-paren">(</span><em>predicted_class</em>, <em>true_class=None</em>, <em>feed=None</em>, <em>sort_by='rising predicted class score'</em>, <em>num_samples=7</em>, <em>num_cols=7</em>, <em>figure_width=15</em>, <em>image_height=3</em>, <em>cache_results=True</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.plot_samples" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot samples of the dataset where the given &lt;predicted_class&gt; was predicted by the model.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>predicted_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>string</em>) – the class string or the index of the class that was predicted by the model.</li>
<li><strong>true_class</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em> or </em><em>string</em>) – the class string or the index of the class that the image actually belongs to.</li>
<li><strong>feed</strong> (<a class="reference internal" href="sconce.data_feeds.html#sconce.data_feeds.base.DataFeed" title="sconce.data_feeds.base.DataFeed"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFeed</span></code></a>) – the DataFeed to use to find the samples.</li>
<li><strong>sort_by</strong> (<em>string</em>) – one of the sort_by strings, see note below.</li>
<li><strong>num_samples</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – the number of sample images to plot.</li>
<li><strong>num_cols</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a>) – the number of columns to plot, one image per column.</li>
<li><strong>figure_width</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – the size, in matplotlib-inches, for the width of the whole figure.</li>
<li><strong>image_height</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – the size, in matplotlib-inches, for the height of a single image.</li>
<li><strong>cache_results</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.7)"><em>bool</em></a>) – keep the results in memory to make subsequent plots faster.  Beware, that on large
datasets (like imagenet) this can cause your system to run out of memory.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<dl class="last docutils">
<dt>The sort_by strings supported are:</dt>
<dd><ul class="first last simple">
<li>“rising predicted class score”: samples are plotted in order of the lowest predicted class score to
the highest predicted class score.</li>
<li>“falling predicted class score”: samples are plotted in order of the higest predicted class score to
the lowest predicted class score.</li>
<li>“rising true class score”: samples are plotted in order of the lowest true class score to
the highest true class score.</li>
<li>“falling true class score”: samples are plotted in order of the higest true class score to
the lowest true class score.</li>
</ul>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.restore">
<code class="descname">restore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore model to previously checkpointed state.  See also <a class="reference internal" href="#sconce.trainer.Trainer.checkpoint" title="sconce.trainer.Trainer.checkpoint"><code class="xref py py-meth docutils literal notranslate"><span class="pre">checkpoint()</span></code></a>.</p>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.save_model_state">
<code class="descname">save_model_state</code><span class="sig-paren">(</span><em>filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.save_model_state" title="Permalink to this definition">¶</a></dt>
<dd><p>Save model state to a file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> (<em>path</em><em>, </em><em>optional</em>) – the filename to save the model state to.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a system dependent temporary location will be chosen.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the passed in filename, or the temporary filename chosen if <code class="docutils literal notranslate"><span class="pre">None</span></code> was passed in.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">filename (path)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.survey_learning_rate">
<code class="descname">survey_learning_rate</code><span class="sig-paren">(</span><em>*</em>, <em>num_epochs=1.0</em>, <em>min_learning_rate=1e-12</em>, <em>max_learning_rate=10</em>, <em>monitor=None</em>, <em>batch_multiplier=1</em>, <em>stop_factor=10</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.survey_learning_rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Checkpoints a model, then runs a learning rate survey, before restoring the model back.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name" colspan="2">Keyword Arguments:</th></tr>
<tr class="field-odd field"><td>&#160;</td><td class="field-body"><ul class="first simple">
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the number of epochs to train the model for.</li>
<li><strong>min_learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the minimum learning rate used in the survey.</li>
<li><strong>max_learning_rate</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – (0.0, inf) the maximum learning rate used in the survey.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
the learning rate survey.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</li>
<li><strong>batch_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – [1, inf) determines how often parameter updates will occur during
training.  If greater than 1, this simulates large batch sizes without increasing memory usage.  For
example, if the batch size were 100 and batch_multipler=10, the effective batch size would be 1,000, but
the memory usage would be for a batch size of 100.</li>
<li><strong>stop_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – (1.0, inf) determines early stopping.  If the <cite>training loss</cite> rises by more than
this factor from it’s minimum value, the survey will stop.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the monitor used during this learning rate survey.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.train">
<code class="descname">train</code><span class="sig-paren">(</span><em>*</em>, <em>num_epochs</em>, <em>monitor=None</em>, <em>validation_to_train_ratio=None</em>, <em>batch_multiplier=1</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the model for a given number of epochs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a>) – the number of epochs to train the model for.</li>
<li><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – a monitor to use for this training session.
If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then self.monitor will be used.</li>
<li><strong>validation_to_train_ratio</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.7)"><em>float</em></a><em>, </em><em>optional</em>) – [0.0, 1.0] determines how often (relative to training samples)
that test samples are run through the model during training.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, then the relative size of the
training and test datasets is used.  For example, for MNIST with 60,000 training samples and 10,000 test
samples, the value would be 1/6th.</li>
<li><strong>batch_multiplier</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.7)"><em>int</em></a><em>, </em><em>optional</em>) – [1, inf) determines how often parameter updates will occur during
training.  If greater than 1, this simulates large batch sizes without increasing memory usage.  For
example, if the batch size were 100 and batch_multipler=10, the effective batch size would be 1,000, but
the memory usage would be for a batch size of 100.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">the monitor used during training.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sconce.trainers.SingleClassImageClassifierTrainer.validate">
<code class="descname">validate</code><span class="sig-paren">(</span><em>*</em>, <em>monitor=None</em><span class="sig-paren">)</span><a class="headerlink" href="#sconce.trainers.SingleClassImageClassifierTrainer.validate" title="Permalink to this definition">¶</a></dt>
<dd><p>Run all samples of self.validation_feed through the model in test (inference) mode.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>monitor</strong> (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>, optional) – the sconce monitor that records data during
this testing.  If <code class="docutils literal notranslate"><span class="pre">None</span></code>, a composite monitor consisting of a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.stdout_monitor.StdoutMonitor" title="sconce.monitors.stdout_monitor.StdoutMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">StdoutMonitor</span></code></a> and a
<a class="reference internal" href="sconce.monitors.html#sconce.monitors.dataframe_monitor.DataframeMonitor" title="sconce.monitors.dataframe_monitor.DataframeMonitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataframeMonitor</span></code></a> will be created for you and used.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the monitor used during this testing.</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">monitor (<a class="reference internal" href="sconce.monitors.html#sconce.monitors.base.Monitor" title="sconce.monitors.base.Monitor"><code class="xref py py-class docutils literal notranslate"><span class="pre">Monitor</span></code></a>)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="schedules.html" class="btn btn-neutral" title="Schedules" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Pytorch-Sconce Contributors.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'master',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>